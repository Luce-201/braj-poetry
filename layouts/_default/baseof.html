<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ if .Title }}{{ .Title }} — {{ end }}{{ .Site.Params.siteName }}</title>
  <meta name="description" content="{{ .Site.Params.description }}">
  
  <!-- Apply saved language BEFORE render to prevent flash -->
  <script>
    (function() {
      var lang = localStorage.getItem('braj_lang') || 'hi';
      document.documentElement.setAttribute('data-lang', lang);
    })();
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Tiro+Devanagari+Hindi:ital@0;1&family=Lora:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/search.css">
</head>
<body>
<header class="site-header">
  <div class="header-inner">
    <a href="/" class="site-logo">
      <span class="logo-hi">{{ .Site.Params.siteName }}</span>
      <span class="logo-en">{{ .Site.Params.siteNameEn }}</span>
    </a>
    <nav class="main-nav">
      <a href="/poems/">
        <span class="lang-hi">कविताएँ</span>
        <span class="lang-en">Poems</span>
      </a>
      <a href="/poets/">
        <span class="lang-hi">कवि</span>
        <span class="lang-en">Poets</span>
      </a>
      <a href="/themes/">
        <span class="lang-hi">विषय</span>
        <span class="lang-en">Themes</span>
      </a>
      <a href="/collections/">
        <span class="lang-hi">संग्रह</span>
        <span class="lang-en">Collections</span>
      </a>

      <!-- ── Tools dropdown ── -->
      <div class="nav-dropdown">
        <button class="nav-dropdown-toggle" id="tools-toggle" aria-haspopup="true" aria-expanded="false">
          <span class="lang-hi">उपकरण</span>
          <span class="lang-en">Tools</span>
          <span class="dropdown-arrow">▾</span>
        </button>
        <div class="nav-dropdown-menu" id="tools-menu" role="menu">
          <a href="/tools/meter-analyzer/" role="menuitem">
            <span class="tool-icon">◎</span>
            <span class="tool-info">
              <span class="tool-name lang-en">Meter Analyzer</span>
              <span class="tool-name-hi lang-hi">छंद विश्लेषक</span>
            </span>
          </a>
          <a href="/tools/rhyme-dictionary/" role="menuitem">
            <span class="tool-icon">◈</span>
            <span class="tool-info">
              <span class="tool-name lang-en">Rhyme Dictionary</span>
              <span class="tool-name-hi lang-hi">तुक शब्दकोश</span>
            </span>
          </a>
        </div>
      </div>
      <!-- ── end Tools dropdown ── -->

      <button class="lang-toggle" id="lang-toggle" onclick="toggleLang()">English</button>
    </nav>
    <div class="header-search" id="header-search-form">
      <div class="header-search-wrap">
        <svg class="header-search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
          <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>
        </svg>
        <input
          type="search"
          id="header-search-input"
          class="header-search-input"
          placeholder="खोजें / Search…"
          autocomplete="off"
        >
      </div>
    </div>
  </div>
</header>

<div id="word-tooltip" class="word-tooltip hidden">
  <span class="tooltip-word"></span>
  <span class="tooltip-meaning"></span>
  <button class="tooltip-close" onclick="closeTooltip()">✕</button>
</div>

<main class="main-content">
  {{ block "main" . }}{{ end }}
</main>

<footer class="site-footer">
  <span class="lang-hi">ब्रज काव्य कोश</span>
  <span class="lang-en">Braj Kavya Kosha</span>
</footer>

{{ $dict := index .Site.Data "dictionary" }}
{{ if $dict }}
<script>
  window.BRAJ_DICTIONARY = {{ $dict | jsonify }};
</script>
{{ end }}

<script src="/js/dictionary.js"></script>
<script src="/js/lang.js"></script>
<script src="/js/fuse.min.js"></script>
<script src="/js/search.js"></script>
<script src="/js/nav.js"></script>
</body>
</html>
